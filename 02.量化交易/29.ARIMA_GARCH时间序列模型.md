# ARIMA 与 GARCH 时间序列模型：均值建模 + 波动建模（详细版）

## 目录
1. [整体框架：均值过程与波动过程](#一-整体框架均值过程与波动过程)
2. [ARIMA：原理与推导](#二-arima原理与推导)
3. [ARIMA：识别、估计与诊断（Box-Jenkins）](#三-arima识别估计与诊断box-jenkins)
4. [ARIMA：预测与扩展（SARIMA / ARIMAX）](#四-arima预测与扩展sarima--arimax)
5. [ARCH/GARCH：原理与性质](#五-archgarch原理与性质)
6. [GARCH：扩展模型（厚尾/杠杆效应）](#六-garch扩展模型厚尾杠杆效应)
7. [估计、诊断与预测：从残差到风险度量](#七-估计诊断与预测从残差到风险度量)
8. [ARIMA-GARCH 组合与滚动建模](#八-arima-garch-组合与滚动建模)
9. [量化交易中的典型应用](#九-量化交易中的典型应用)
10. [常见坑与实践建议](#十-常见坑与实践建议)
11. [总结](#十一-总结)

---

## 一、整体框架：均值过程与波动过程

金融时间序列（尤其是收益率）经常呈现：
- **均值可预测性弱**（return 的线性自相关很小）
- **波动可预测性强**（波动聚类、厚尾、杠杆效应）

因此经典拆解是：

\[\textbf{均值方程（ARIMA/ARMA 等）} \quad + \quad \textbf{波动方程（GARCH 系列）}\]

设 $r_t$ 为收益率或已平稳化后的序列：

$$
r_t = \mu_t + \varepsilon_t,\qquad \varepsilon_t = \sigma_t z_t
$$

- $\mu_t$：条件均值（用 ARMA/ARIMA/SARIMA/ARIMAX 等解释）
- $\sigma_t^2$：条件方差（用 ARCH/GARCH/EGARCH/GJR 等解释）
- $z_t$：标准化残差，常假设 i.i.d.，分布可取正态或 t 分布等
### 1.1 为什么要把“均值”和“波动”分开建模

- **统计结构不同**：均值依赖线性自相关；波动依赖平方残差的自相关（ARCH 效应）。
- **决策用途不同**：
  - 均值预测：更偏向方向/相对价值/择时
  - 波动预测：更偏向仓位大小、杠杆、止损、VaR/ES、期权定价
- **稳健性考虑**：均值端的估计误差通常更致命（容易过拟合），波动端相对更稳定。

### 1.2 两个关键的“平稳性”概念（别混淆）

- **均值过程平稳**：$\{r_t\}$ 的均值、方差、自协方差不随时间变（弱平稳）。ARMA/ARIMA 的理论依赖这一点。
- **波动过程平稳**：$\{\sigma_t^2\}$ 有稳定的长期均值（例如 GARCH(1,1) 需要 $\alpha+\beta<1$）。

---

## 二、ARIMA：原理与推导

ARIMA(p,d,q) 的核心是：

1) 对非平稳序列做差分使其平稳；
2) 在差分后的序列上拟合 ARMA(p,q)。

记滞后算子 $L$：$Lx_t=x_{t-1}$。

### 2.1 差分与 I(d)（单位根/随机趋势）

一阶差分：
$$
\nabla x_t = (1-L)x_t = x_t-x_{t-1}
$$

d 阶差分：
$$
\nabla^d x_t = (1-L)^d x_t
$$

若原序列 $x_t$ 非平稳、但 $\nabla^d x_t$ 平稳，则称 $x_t$ 为 **I(d)** 过程。

- 价格序列常近似 I(1)
- 对数价格差分（对数收益）常近似 I(0)
### 2.2 AR、MA、ARMA 的统一写法（滞后算子）

**AR(p)：**

$$x_t = c + \sum_{i=1}^{p}\phi_i x_{t-i} + \varepsilon_t$$

用滞后算子可写为：

$$\Phi(L)x_t = c + \varepsilon_t,\quad \Phi(L)=1-\phi_1L-\cdots-\phi_pL^p$$

**MA(q)：**

$$x_t = c + \varepsilon_t + \sum_{j=1}^{q}\theta_j\varepsilon_{t-j}$$

滞后算子写法：

$$x_t = c + \Theta(L)\varepsilon_t,\quad \Theta(L)=1+\theta_1L+\cdots+\theta_qL^q$$

**ARMA(p,q)：**

$$\Phi(L)x_t = c + \Theta(L)\varepsilon_t$$

其中 $\varepsilon_t$ 通常假设为白噪声（至少不自相关）。

### 2.3 ARIMA(p,d,q) 的统一写法

把差分算子并入 ARMA：

$$\Phi(L)(1-L)^d x_t = c + \Theta(L)\varepsilon_t$$

这就是 ARIMA 的“定义式”：**差分使平稳 + ARMA 刻画线性相关结构**。
### 2.4 平稳性与可逆性（ARMA 的两个“生命线”）

**1）AR 部分的平稳性（stationarity）**

AR(p) 过程平稳的充分必要条件：

- 多项式 $\Phi(z)=1-\phi_1 z-\cdots-\phi_p z^p$ 的所有根都在单位圆外（$|z|>1$）。

直觉：冲击会衰减，不会越滚越大。

**2）MA 部分的可逆性（invertibility）**

MA(q) 可逆的充分必要条件：

- 多项式 $\Theta(z)=1+\theta_1 z+\cdots+\theta_q z^q$ 的所有根都在单位圆外。

直觉：能把 MA 过程等价表示成一个收敛的 AR(∞)，便于估计与解释。

### 2.5 ACF / PACF 的典型形态（识别阶数的直觉）

设序列已平稳（I(0)）。

- **AR(p)**：PACF 在 p 阶“截尾”（cut off），ACF “拖尾”（tail off）
- **MA(q)**：ACF 在 q 阶截尾，PACF 拖尾
- **ARMA(p,q)**：ACF 与 PACF 通常都拖尾

> 注意：这是“典型形态”，金融数据噪声大、样本短时不要迷信图形，一般要配合 AIC/BIC 与残差检验。
---

## 三、ARIMA：识别、估计与诊断（Box-Jenkins）

Box–Jenkins 经典流程：**识别（Identify）→ 估计（Estimate）→ 诊断（Diagnose）→ 预测（Forecast）**。

### 3.1 识别（Identify）：先让序列“像平稳序列”

1) **画图**：趋势、季节性、异常点、结构突变

2) **单位根/平稳性检验（常用组合）**
- **ADF**：原假设“有单位根（非平稳）”
- **KPSS**：原假设“平稳”

经验做法：ADF + KPSS 交叉验证，避免单检验误判。

3) **确定差分阶 d**
- 价格常取 d=1（或取对数后差分）
- 过度差分会引入负相关，造成模型错配

### 3.2 阶数选择（p,q）：图形 + 信息准则

- 候选集：小范围网格（例如 p,q ∈ {0,1,2,3}）
- 评价：AIC/BIC（BIC 更偏向简化，AIC 更偏向拟合）

常用信息准则形式：

$$\text{AIC}=2k-2\log \hat L,\qquad \text{BIC}=k\log n-2\log \hat L$$

其中 k 是参数数目，n 是样本量。
### 3.3 参数估计：极大似然（MLE）为主

ARIMA/ARMA 通常用 MLE 或条件 MLE 估计。

- 正态假设不是必须“真的正态”，但常作为似然函数的工作假设
- 金融收益厚尾时，可改用 t 分布残差（会更稳健）

### 3.4 诊断：残差必须“像白噪声”

拟合后得到残差 $\hat\varepsilon_t$，关键检查：

1) **残差自相关**：Ljung–Box 检验
- 原假设：前若干阶自相关为 0（无剩余线性结构）

2) **异方差（ARCH效应）**：Engle’s ARCH LM 检验
- 若显著 → 说明波动聚类存在 → 进入 GARCH 建模

3) **分布形态**：偏度/峰度、Q-Q 图（非必需，但对风险度量重要）

### 3.5 什么时候 ARIMA“很好”，什么时候“没啥用”

- **有用**：宏观指标、利率/利差、某些高频微结构序列、库存/需求类数据
- **偏弱**：股票日频收益（均值端信号很弱），但仍可作为均值方程的基底
---

## 四、ARIMA：预测与扩展（SARIMA / ARIMAX）

### 4.1 ARIMA 的点预测与区间预测

**点预测（Point Forecast）：**

对于 ARIMA(p,d,q) 模型，在时刻 $T$ 预测 $h$ 步未来：

$$\hat{x}_{T+h|T} = E[x_{T+h} \mid \mathcal{F}_T]$$

其中 $\mathcal{F}_T$ 是到时刻 $T$ 的信息集。

**递归预测公式：**

- 对于 AR 部分：用已预测值递归计算
- 对于 MA 部分：未来误差项用期望值 0 代替

**预测误差方差：**

$$V_{T+h|T} = \text{Var}(x_{T+h} - \hat{x}_{T+h|T})$$

**区间预测：**

在正态假设下，$h$ 步预测的 $(1-\alpha)$ 置信区间：

$$\hat{x}_{T+h|T} \pm z_{\alpha/2} \sqrt{V_{T+h|T}}$$

### 4.2 SARIMA：季节性 ARIMA

**SARIMA(p,d,q)(P,D,Q)_s 模型：**

$$\Phi(L)\Phi_s(L^s)(1-L)^d(1-L^s)^D x_t = \Theta(L)\Theta_s(L^s)\varepsilon_t$$

其中：
- $s$：季节周期（如月度数据 $s=12$，季度数据 $s=4$）
- $(P,D,Q)_s$：季节部分的 AR、差分、MA 阶数
- $\Phi_s(L^s)$：季节 AR 多项式
- $\Theta_s(L^s)$：季节 MA 多项式

**应用场景：**
- 月度/季度经济数据
- 具有明显季节性的金融指标（如某些商品期货）

### 4.3 ARIMAX：带外生变量的 ARIMA

**ARIMAX(p,d,q) 模型：**

$$\Phi(L)(1-L)^d x_t = c + \sum_{j=1}^{k}\beta_j z_{j,t} + \Theta(L)\varepsilon_t$$

其中 $z_{j,t}$ 是外生变量（如宏观经济指标、其他资产收益率等）。

**在量化交易中的应用：**
- 用市场因子解释个股收益
- 用宏观经济变量预测资产价格
- 多资产联合建模

---

## 五、ARCH/GARCH：原理与性质

### 5.1 ARCH 模型：条件异方差的起点

**ARCH(q) 模型（Engle, 1982）：**

$$
\begin{aligned}
r_t &= \mu_t + \varepsilon_t \\
\varepsilon_t &= \sigma_t z_t \\
\sigma_t^2 &= \omega + \sum_{i=1}^{q} \alpha_i \varepsilon_{t-i}^2
\end{aligned}
$$

其中：
- $\mu_t$：条件均值（可以是常数或 ARMA 模型）
- $z_t \sim \text{i.i.d.}(0,1)$：标准化残差
- $\omega > 0$，$\alpha_i \geq 0$：ARCH 参数

**核心思想：**
- 条件方差 $\sigma_t^2$ 依赖于过去 $q$ 期的平方残差
- 捕捉"波动聚类"现象：大波动后往往跟随大波动

### 5.2 GARCH(p,q)：ARCH 的推广

**GARCH(p,q) 模型（Bollerslev, 1986）：**

$$
\begin{aligned}
r_t &= \mu_t + \varepsilon_t \\
\varepsilon_t &= \sigma_t z_t \\
\sigma_t^2 &= \omega + \sum_{i=1}^{q} \alpha_i \varepsilon_{t-i}^2 + \sum_{j=1}^{p} \beta_j \sigma_{t-j}^2
\end{aligned}
$$

**关键改进：**
- 增加了 $\sigma_{t-j}^2$ 项，使波动率具有"记忆性"
- 通常用更少的参数（如 GARCH(1,1)）就能达到 ARCH(q) 的效果

### 5.3 GARCH(1,1)：最常用的形式

**GARCH(1,1) 模型：**

$$\sigma_t^2 = \omega + \alpha \varepsilon_{t-1}^2 + \beta \sigma_{t-1}^2$$

**参数解释：**
- $\omega > 0$：长期波动率水平
- $\alpha \geq 0$：ARCH 项系数，反映"新闻效应"（新冲击对波动的影响）
- $\beta \geq 0$：GARCH 项系数，反映"波动持续性"（波动率的惯性）

**典型参数值（金融数据）：**
- $\alpha + \beta \approx 0.95-0.99$：波动高度持久
- $\alpha \approx 0.05-0.15$：新冲击的影响
- $\beta \approx 0.80-0.95$：波动的惯性

### 5.4 GARCH 的平稳性条件

**无条件方差：**

对 GARCH(1,1) 取期望：

$$E[\sigma_t^2] = \omega + \alpha E[\varepsilon_{t-1}^2] + \beta E[\sigma_{t-1}^2]$$

在平稳条件下，$E[\sigma_t^2] = E[\sigma_{t-1}^2] = \bar{\sigma}^2$，且 $E[\varepsilon_{t-1}^2] = E[\sigma_{t-1}^2]$，因此：

$$\bar{\sigma}^2 = \frac{\omega}{1-\alpha-\beta}$$

**平稳性条件：**

$$\alpha + \beta < 1$$

如果 $\alpha + \beta = 1$，称为 **IGARCH**（Integrated GARCH），无条件方差不存在。

如果 $\alpha + \beta > 1$，过程非平稳（实际中很少见）。

### 5.5 GARCH 的长期均值与半衰期

**长期波动率水平：**

$$\bar{\sigma}^2 = \frac{\omega}{1-\alpha-\beta}$$

**波动率冲击的半衰期：**

假设在时刻 $t$ 有一个单位冲击 $\varepsilon_t^2 = 1$，其对未来波动率的影响：

$$\frac{\partial \sigma_{t+h}^2}{\partial \varepsilon_t^2} = \alpha \beta^{h-1}$$

半衰期（影响衰减到一半的时间）：

$$h_{1/2} = \frac{\log(2)}{\log(\beta)}$$

当 $\beta \approx 0.9$ 时，半衰期约为 6-7 期。

---

## 六、GARCH：扩展模型（厚尾/杠杆效应）

### 6.1 非正态分布：t-GARCH

**问题：** 金融收益率的分布通常比正态分布更"厚尾"（极端事件更常见）。

**解决方案：** 假设标准化残差 $z_t$ 服从 t 分布：

$$z_t \sim t_\nu(0,1)$$

其中 $\nu$ 是自由度参数（通常 $\nu \in [3,10]$）。

**t 分布的优势：**
- 能更好地捕捉极端事件
- 在 VaR 计算中更准确
- 当 $\nu \to \infty$ 时，t 分布收敛到正态分布

### 6.2 杠杆效应：EGARCH 与 GJR-GARCH

**杠杆效应（Leverage Effect）：**
- 负收益（坏消息）对波动率的影响通常大于正收益（好消息）
- 这是金融市场的典型特征

#### 6.2.1 EGARCH 模型（Exponential GARCH）

**EGARCH(1,1) 模型：**

$$\log(\sigma_t^2) = \omega + \alpha \left(\frac{|\varepsilon_{t-1}|}{\sigma_{t-1}} - E\left[\frac{|\varepsilon_{t-1}|}{\sigma_{t-1}}\right]\right) + \gamma \frac{\varepsilon_{t-1}}{\sigma_{t-1}} + \beta \log(\sigma_{t-1}^2)$$

**关键特点：**
- 对 $\sigma_t^2$ 取对数，保证方差始终为正（无需约束）
- $\gamma$ 项捕捉杠杆效应：
  - $\gamma < 0$：负收益增加波动率更多
  - $\gamma = 0$：对称响应

#### 6.2.2 GJR-GARCH 模型（Glosten-Jagannathan-Runkle）

**GJR-GARCH(1,1) 模型：**

$$\sigma_t^2 = \omega + \alpha \varepsilon_{t-1}^2 + \gamma I_{t-1} \varepsilon_{t-1}^2 + \beta \sigma_{t-1}^2$$

其中 $I_{t-1} = 1$ 当 $\varepsilon_{t-1} < 0$，否则 $I_{t-1} = 0$。

**参数解释：**
- $\alpha$：正收益对波动的影响
- $\alpha + \gamma$：负收益对波动的影响
- 杠杆效应：$\gamma > 0$

### 6.3 其他 GARCH 扩展

**1. GARCH-M（GARCH in Mean）**
- 将条件方差引入均值方程
- 捕捉"风险溢价"：高风险对应高收益

**2. 多变量 GARCH（MGARCH）**
- 建模多个资产收益率的协方差矩阵
- 用于投资组合风险管理

**3. 长记忆 GARCH（FIGARCH）**
- 捕捉波动率的长期记忆
- 适用于高频数据

---

## 七、估计、诊断与预测：从残差到风险度量

### 7.1 GARCH 模型的估计

**极大似然估计（MLE）：**

对于 GARCH 模型，似然函数：

$$L(\boldsymbol{\theta}) = \prod_{t=1}^{T} f(r_t \mid \mathcal{F}_{t-1}; \boldsymbol{\theta})$$

其中 $f(\cdot)$ 是条件密度函数（正态或 t 分布）。

**对数似然函数：**

$$\ell(\boldsymbol{\theta}) = \sum_{t=1}^{T} \log f(r_t \mid \mathcal{F}_{t-1}; \boldsymbol{\theta})$$

对于正态 GARCH：

$$\ell(\boldsymbol{\theta}) = -\frac{T}{2}\log(2\pi) - \frac{1}{2}\sum_{t=1}^{T}\left[\log(\sigma_t^2) + \frac{\varepsilon_t^2}{\sigma_t^2}\right]$$

**数值优化：**
- 通常使用拟牛顿法（如 BFGS）或梯度下降
- 需要良好的初始值（可用两步估计法）

### 7.2 模型诊断

**1. 标准化残差检验：**

$$\tilde{z}_t = \frac{\hat{\varepsilon}_t}{\hat{\sigma}_t}$$

标准化残差应该：
- 无自相关（Ljung-Box 检验）
- 无 ARCH 效应（ARCH LM 检验）
- 近似独立同分布

**2. 分布检验：**
- Q-Q 图：检查是否服从假设分布
- Jarque-Bera 检验：正态性检验
- Kolmogorov-Smirnov 检验：分布拟合检验

**3. 参数显著性：**
- t 检验：检验参数是否显著
- 似然比检验：比较嵌套模型

### 7.3 波动率预测

**一步预测：**

$$\hat{\sigma}_{T+1|T}^2 = \omega + \alpha \hat{\varepsilon}_T^2 + \beta \hat{\sigma}_T^2$$

**多步预测（GARCH(1,1)）：**

对于 $h > 1$：

$$\hat{\sigma}_{T+h|T}^2 = \bar{\sigma}^2 + (\alpha + \beta)^{h-1}(\hat{\sigma}_{T+1|T}^2 - \bar{\sigma}^2)$$

其中 $\bar{\sigma}^2 = \omega/(1-\alpha-\beta)$ 是长期波动率水平。

**预测收敛：**
- 当 $h \to \infty$ 时，$\hat{\sigma}_{T+h|T}^2 \to \bar{\sigma}^2$
- 波动率预测会收敛到长期水平

### 7.4 风险度量：VaR 与 ES

#### 7.4.1 风险价值（VaR）

**定义：** 在给定置信水平 $\alpha$ 和时间 horizon $h$ 下，投资组合的最大可能损失。

**基于 GARCH 的 VaR：**

对于 GARCH 模型，$h$ 步 VaR：

$$\text{VaR}_{\alpha,h} = -\hat{\mu}_{T+h|T} + \hat{\sigma}_{T+h|T} \cdot z_\alpha$$

其中 $z_\alpha$ 是标准分布（正态或 t 分布）的 $\alpha$ 分位数。

**动态 VaR：**
- 使用 GARCH 预测的条件波动率
- 能捕捉波动率的时变性

#### 7.4.2 期望损失（ES / CVaR）

**定义：** 超过 VaR 的损失的期望值。

$$\text{ES}_\alpha = E[r_t \mid r_t < -\text{VaR}_\alpha]$$

**基于 GARCH 的 ES：**

对于正态分布：
$$\text{ES}_\alpha = -\hat{\mu}_{T+h|T} + \hat{\sigma}_{T+h|T} \cdot \frac{\phi(z_\alpha)}{\alpha}$$

对于 t 分布，有相应的解析公式。

---

## 八、ARIMA-GARCH 组合与滚动建模

### 8.1 ARIMA-GARCH 组合模型

**完整模型结构：**

$$
\begin{aligned}
r_t &= \mu_t + \varepsilon_t \quad \text{（均值方程：ARIMA）} \\
\varepsilon_t &= \sigma_t z_t \\
\sigma_t^2 &= \omega + \alpha \varepsilon_{t-1}^2 + \beta \sigma_{t-1}^2 \quad \text{（波动方程：GARCH）}
\end{aligned}
$$

**建模步骤：**

1. **第一步：拟合均值方程（ARIMA）**
   - 识别 ARIMA 阶数
   - 估计参数
   - 得到残差 $\hat{\varepsilon}_t$

2. **第二步：检验 ARCH 效应**
   - 对残差进行 ARCH LM 检验
   - 如果显著，进入第三步

3. **第三步：拟合 GARCH 模型**
   - 在均值方程的残差上拟合 GARCH
   - 联合估计所有参数（或两步估计）

### 8.2 滚动窗口估计

**问题：** 金融市场的参数可能随时间变化（结构突变）。

**解决方案：** 使用滚动窗口重新估计模型。

**滚动窗口流程：**

1. 选择窗口长度 $W$（如 252 个交易日 = 1 年）
2. 在时刻 $t$，使用 $[t-W+1, t]$ 的数据估计模型
3. 预测 $t+1$ 时刻的均值和波动率
4. 移动到 $t+1$，重复步骤 2-3

**窗口长度选择：**
- 太短：估计不稳定，噪声大
- 太长：无法捕捉参数变化
- 经验值：日频数据常用 252-504 个交易日

### 8.3 模型更新频率

**固定窗口 vs 扩展窗口：**
- **固定窗口**：始终保持 $W$ 个观测值，丢弃旧数据
- **扩展窗口**：不断增加数据，使用所有历史数据

**选择建议：**
- 如果参数稳定：使用扩展窗口（更稳健）
- 如果参数时变：使用固定窗口（更灵活）

---

## 九、量化交易中的典型应用

### 9.1 波动率预测与仓位管理

**应用场景：**
- 根据预测波动率调整仓位大小
- 高波动时降低杠杆，低波动时增加杠杆

**实现方式：**
$$\text{仓位} = \frac{\text{目标波动率}}{\hat{\sigma}_{t+1|t}} \times \text{基准仓位}$$

### 9.2 风险度量与 VaR 计算

**应用场景：**
- 实时监控投资组合风险
- 设置止损线
- 风险预算分配

**优势：**
- 动态 VaR 比静态 VaR 更准确
- 能捕捉波动率聚类

### 9.3 期权定价与波动率交易

**应用场景：**
- 使用 GARCH 预测的波动率作为 Black-Scholes 模型的输入
- 识别波动率被高估/低估的期权
- 波动率套利策略

### 9.4 配对交易与协整

**应用场景：**
- 使用 ARIMA 建模价差序列
- 识别均值回复机会
- 结合 GARCH 管理价差波动风险

### 9.5 因子模型与风险分解

**应用场景：**
- 将资产收益率分解为因子暴露和特质收益
- 使用 GARCH 建模因子波动率
- 动态风险归因

---

## 十、常见坑与实践建议

### 10.1 常见陷阱

**1. 过度拟合**
- 问题：选择过于复杂的模型（高阶 ARIMA/GARCH）
- 表现：样本内拟合好，样本外预测差
- 解决：使用信息准则（BIC 更保守）、交叉验证

**2. 忽略结构突变**
- 问题：市场制度变化导致参数不稳定
- 表现：模型突然失效
- 解决：滚动窗口估计、结构突变检验

**3. 分布假设错误**
- 问题：假设正态分布，但实际厚尾
- 表现：VaR 低估风险
- 解决：使用 t 分布或其他厚尾分布

**4. 忽略杠杆效应**
- 问题：使用对称 GARCH，忽略负收益的影响
- 表现：波动率预测不准确
- 解决：使用 EGARCH 或 GJR-GARCH

**5. 数据质量问题**
- 问题：异常值、缺失值、数据错误
- 表现：参数估计偏差
- 解决：数据清洗、异常值处理

### 10.2 实践建议

**1. 从简单模型开始**
- 先尝试 ARIMA(1,1,1) + GARCH(1,1)
- 如果不够，再逐步增加复杂度

**2. 重视模型诊断**
- 残差检验是必须的
- 不要只看拟合优度，要看预测能力

**3. 样本外验证**
- 始终保留一部分数据用于样本外测试
- 使用滚动窗口进行伪样本外预测

**4. 稳健性检查**
- 尝试不同的分布假设
- 尝试不同的窗口长度
- 检查参数稳定性

**5. 结合领域知识**
- 理解金融市场的特征（杠杆效应、波动聚类）
- 根据应用场景选择模型（VaR 需要厚尾，期权定价需要准确波动率）

---

## 十一、总结

### 11.1 核心要点

**ARIMA 模型：**
- 用于建模时间序列的**均值过程**
- 通过差分处理非平稳性
- 捕捉线性自相关结构
- 适用于趋势、季节性明显的序列

**GARCH 模型：**
- 用于建模时间序列的**波动过程**
- 捕捉波动聚类现象
- 提供动态波动率预测
- 适用于风险管理、VaR 计算

**组合模型：**
- ARIMA 处理均值，GARCH 处理波动
- 两者结合能更全面地描述金融时间序列
- 在量化交易中有广泛应用

### 11.2 关键公式总结

**ARIMA(p,d,q)：**
$$\Phi(L)(1-L)^d x_t = c + \Theta(L)\varepsilon_t$$

**GARCH(1,1)：**
$$\sigma_t^2 = \omega + \alpha \varepsilon_{t-1}^2 + \beta \sigma_{t-1}^2$$

**平稳性条件：**
- ARIMA：AR 多项式根在单位圆外
- GARCH：$\alpha + \beta < 1$

**长期波动率：**
$$\bar{\sigma}^2 = \frac{\omega}{1-\alpha-\beta}$$

**VaR：**
$$\text{VaR}_\alpha = -\hat{\mu} + \hat{\sigma} \cdot z_\alpha$$

### 11.3 建模流程总结

1. **数据准备**：清洗、处理异常值
2. **平稳性检验**：ADF、KPSS 检验
3. **均值建模**：识别 ARIMA 阶数，估计参数
4. **ARCH 效应检验**：检验残差的异方差性
5. **波动建模**：如果存在 ARCH 效应，拟合 GARCH
6. **模型诊断**：残差检验、分布检验
7. **预测与评估**：样本外预测、评估预测精度
8. **应用**：风险管理、仓位调整、VaR 计算

### 11.4 进一步学习

**相关主题：**
- 状态空间模型（State Space Models）
- 随机波动率模型（Stochastic Volatility）
- 多变量 GARCH（MGARCH）
- 长记忆模型（FIGARCH）
- 机器学习方法（LSTM、Transformer）在时间序列中的应用

**在量化交易中的扩展：**
- 高频数据的 GARCH 建模
- 多资产联合建模
- 因子模型的动态波动率
- 机器学习与传统时间序列模型的结合

---

## 参考文献

1. Box, G. E. P., & Jenkins, G. M. (1976). Time Series Analysis: Forecasting and Control. Holden-Day.
2. Engle, R. F. (1982). Autoregressive conditional heteroscedasticity with estimates of the variance of United Kingdom inflation. Econometrica, 50(4), 987-1007.
3. Bollerslev, T. (1986). Generalized autoregressive conditional heteroskedasticity. Journal of Econometrics, 31(3), 307-327.
4. Hamilton, J. D. (1994). Time Series Analysis. Princeton University Press.
5. Tsay, R. S. (2005). Analysis of Financial Time Series. Wiley.
6. Engle, R. F., & Ng, V. K. (1993). Measuring and testing the impact of news on volatility. The Journal of Finance, 48(5), 1749-1778.
7. Glosten, L. R., Jagannathan, R., & Runkle, D. E. (1993). On the relation between the expected value and the volatility of the nominal excess return on stocks. The Journal of Finance, 48(5), 1779-1801.
8. Nelson, D. B. (1991). Conditional heteroskedasticity in asset returns: A new approach. Econometrica, 59(2), 347-370.

---
